- name: Checkout repository
  uses: actions/checkout@v3

- name: Set up Python
  uses: actions/setup-python@v4
  with:
    python-version: "3.x"

- name: Clear pip cache
  run: pip cache purge

- name: Clean docs build
  run: make clean -C docs

- name: Install package
  run: pip install -e .

- name: Install Sphinx and dependencies
  run: |
    python -m pip install --upgrade pip
    pip install sphinx furo sphinx-rtd-theme sphinxcontrib-mermaid

- name: Build the documentation
  run: make html -C docs

- name: Deploy documentation to GitHub Pages
  uses: peaceiris/actions-gh-pages@v3
  with:
    github_token: ${{ secrets.GITHUB_TOKEN }}
    publish_dir: ./docs/_build/html
    force_orphan: true
